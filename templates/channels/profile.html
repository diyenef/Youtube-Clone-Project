{% extends 'base.html' %}

{% block title %}{{ channel.display_name }} - Channel{% endblock %}

{% block content %}
  <div class="channel-header">
    <div class="channel-avatar">
      {% if channel.avatar %}
        <img src="{{ channel.avatar.url }}" alt="{{ channel.display_name }}">
      {% else %}
        <div class="avatar">{{ channel.user.username|slice:":1"|upper }}</div>
      {% endif %}
    </div>
    <div class="channel-info">
      <h2>{{ channel.display_name }}</h2>
      <p class="subscribers">{{ channel.subscribers.count }} subscribers</p>
      <p class="bio">{{ channel.bio }}</p>
    </div>
    <div class="channel-actions">
      {% if request.user.is_authenticated and request.user != channel.user %}
        <form method="post" action="{% url 'toggle_subscribe' username=channel.user.username %}">
          {% csrf_token %}
          <button class="btn" type="submit">{% if is_subscribed %}Subscribed{% else %}Subscribe{% endif %}</button>
        </form>
      {% endif %}
    </div>
  </div>

  <h3>Videos</h3>
  <div class="grid">
    {% for video in videos %}
      <article class="card">
        <a class="thumb" href="{% url 'video_detail' pk=video.pk %}">
          {% if video.thumbnail %}
            <img src="{{ video.thumbnail.url }}" alt="{{ video.title }}">
          {% else %}
            <div class="thumb-placeholder">No thumbnail</div>
          {% endif %}
        </a>
        <div class="card-body">
          <a class="avatar">{{ video.channel.username|slice:":1"|upper }}</a>
          <div class="card-info">
            <a class="title" href="{% url 'video_detail' pk=video.pk %}">{{ video.title }}</a>
            <div class="meta">{{ video.views }} views</div>
          </div>
        </div>
      </article>
    {% empty %}
      <p>No videos yet.</p>
    {% endfor %}
  </div>

{% endblock %}
